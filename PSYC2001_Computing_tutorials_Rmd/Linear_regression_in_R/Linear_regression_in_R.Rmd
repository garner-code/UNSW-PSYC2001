---
title: "Linear regression in R"
output: 
  html_document:
    theme: readable

---

This week, we are going to continue to explore relationships between continuous variables, using simple linear regression.

## Checking installation and loading packages

As usual we first always check and load in our required packages.

```{r message = FALSE, warning= FALSE}
# Check if packages are installed, if not install.
if(!require(here)) install.packages('here') #checks if a package is installed and installs it if required.
if(!require(tidyverse)) install.packages('tidyverse')
if(!require(ggplot2)) install.packages('ggplot2')

library(here) #loads in the specified package
library(tidyverse)
library(ggplot2)
```


## Investigating linear regressions

Last week we looked at the correlation between  social media use, age and political activism. Today we will be using a simple linear regression to determine if political attitude can predict the amount of time spent on social media.

Here is a recap of the variables:

- age – age in years
- time_on_social – average hours/day on social media (self-report diary)

Political attitude which is composed of the subscales: 

- informed – how politically informed they feel (e.g., read news daily)
- campaign – how much they engage in campaign-related discussion
- activism – involvement in activism (e.g., protests, petitions)


## Activity 1 - Formulate your research question

Before we begin we first need to load in our dataset for today. This will be there `PSYC2001-social-media-attitutde` dataset which includes the `attitude` variable we created last week.  Are you able to load this dataset  ? 

```{r }
social_media <- read.csv(file = here("Data","PSYC2001-social-media-attitutde.csv")) #reads in CSV files
```

Will social media use be predicted by political activism ? Which direction do you think this effect will be in ? 

::: {style="border-left: 4px solid #9C27B0; background-color: #F3E5F5; padding: 10px; margin: 10px 0;"}
<strong>Question:</strong> What is a reasonable null and alternate hypothesis? The class will come up with a hypothesis.
:::

## Linear regression in R 

The difference between a regression and correlation is that instead of looking for a statistical relationship between x and y, in regression we are asking if we can predict what y will be, under circumstances we are stuck on a desert island, and we only have access to x.

Let's run a simple linear regression to determine how well political attitude predicts the amount of time spent on social media. To do this we can we can fit a linear regression model using the `lm()` function in R. Please make sure to have a look at this function using the `?` syntax before moving on. To fit our linear regression model we have to specify a formula, similar to how we did in this [tutorial](#independent-samples-t-test). Here the left side in the formula is the dependent variable (`time_on_social`) whereas the right side is the independent/predictor variable (`attitude`). 

```{r}
model<-lm(formula = time_on_social ~ attitude, data = social_media_attitutde ) #since time_on_social is on the left side it is being predicted by attitude 
```

::: {style="border-left: 4px solid #9C27B0; background-color: #F3E5F5; padding: 10px; margin: 10px 0;"}
<strong>Question:</strong> Use the R output to complete the following regression equation:
attitude’ = a + beta*time_on_social.
:::

But think for a second... where is our R^2^ value and our p value ? 

::: {style="border-left: 4px solid #9C27B0; background-color: #F3E5F5; padding: 10px; margin: 10px 0;"}
<strong>Question:</strong> Can we make interpretations about the linear regression without these ?
:::

We can get the **R^2^ and p value** by generating a summary of our linear regression model. To do this we simply use the `summary()` function. 

```{r}
summary(model)
```

::: {style="border-left: 4px solid #2196F3; background-color: #E7F3FE; padding: 10px; margin: 10px 0;"}
<strong>Info:</strong> There are additional statistics that are output from the `lm()` model. They are not critical for interpretation at this point. If you want to know more please see [here](https://feliperego.github.io/blog/2015/10/23/Interpreting-Model-Output-In-R)
:::

::: {style="border-left: 4px solid #9C27B0; background-color: #F3E5F5; padding: 10px; margin: 10px 0;"}
<strong>Question:</strong> Can we make interpretations about the linear regression without these ?
:::

::: {style="border-left: 4px solid #9C27B0; background-color: #F3E5F5; padding: 10px; margin: 10px 0;"}
<strong>Question:</strong> What does this output mean ? What does the R^2^ mean ? How does the R compare to the results of your correlation analysis? Why is this?
:::

## Writing up results and conclusions

Finally, we are going to write up the results and conclusion of the linear regression we have just conducted. 

::: {style="border-left: 4px solid #8B5E3C; background-color: #F5F5DC; padding: 10px; margin: 10px 0;"}
<strong>Results:</strong> A simple linear regression was performed to evaluate the extent that political attitude predicted the amount of time spent on social media. It was found that political attitude weakly predicted the amount of time spent on social media (F(1,56) = 19.95,p < 0.01, R^2^ = 0.26).
:::

What can we conclude from these results? Please write this up!

::: {style="border-left: 4px solid #8B5E3C; background-color: #F5F5DC; padding: 10px; margin: 10px 0;"}
<strong>Conclusions:</strong> Your conclusions go here !
:::

## Plotting our results

To show how well a simple linear regression captures the relationship between two variables you should simply include a straight line of 'best fit' on a scatterplot. This is incredibly useful at visually informing the reader of the linear predicitve relationship between variables. Surprisingly, most people (including researchers) are quite bad at guessing the strength of linear relationships using scatterplots alone !

## Activity 2 - Plotting straight lines

The linear regression line can be added to a `ggplot` graph by using the `geom_smooth` function. Please help to do this by filling in the code below.  

```{r warning= FALSE, message = FALSE}
social_media_attitutde %>% 
  ggplot(aes(x = time_on_social, y = attitude)) +
  geom_point(colour = "red") +
  geom_smooth(method = "lm", se = TRUE) +
  labs(x = "Time on social", y = "Attitude", colour = "black") +
  theme_classic()
```


## You are Free!
  
Well done guys you have survived another computing tutorial. Please check with your tutor that you understand everything !


```{r, echo=FALSE, out.width="50%", fig.align='center', fig.cap="It almost over (I promise)"}
knitr::include_graphics("https://github.com/BsoCool/UNSW-PSYC2001/blob/main/All%20images%20for%20computing%20tutorials/Linear_regression_in_R/Done.jpg?raw=true")
```




